<%
  comment_and_comments_container = render('comments/comment', comment: @comment) do
    render('form', comment: @comment.children.build)
    content_tag(:div, '', class: 'comments', 'data-commentable-id' => @comment.id)
  end
%>

commentsContainer = $("div#comment-<%= @comment.parent_id %> > .comments");
commentsContainer.prepend("<%= escape_javascript(comment_and_comments_container) %>");
$('#comment-<%= @comment.parent_id %> > form').hide();

commentsCountSpan = $("span#comments-count-<%= reference.id %>");
commentsCount = parseInt(commentsCountSpan.text());
commentsCountSpan.text(parseInt(commentsCount) + 1);
